# 介绍

在Linux中, 程序发布时, 不会携带所需的依赖包, **包管理器**(Package Manager)用于解决该问题, 它会解析程序所需依赖包, 从**软件仓库**(Software Repository)中下载.

> 依赖就是二进制程序, 如同Windows的DLL, Java的Jar

通常在Linux中, 一个依赖只能存在一份, 因此当多个程序依赖于依赖的不同版本时, 冲突了, 造成[依赖地狱](https://en.wikipedia.org/wiki/Dependency_hell). 发行版维护的软件仓库缓解了依赖地狱的问题, 一般软件仓库中的所有包都不会冲突, 但是不能保证从第三方仓库中安装软件时不会造成依赖冲突.

> 这也是为啥每个不同的发行版都有一个软件仓库的原因
>
> 在Windows中, 允许软件自带依赖, 于是系统中可以存在多个不同版本的依赖, 从而解决软件依赖冲突.

Linux中冲突时咋解决? Google吧..

> 参考: [Dependency hell](https://en.wikipedia.org/wiki/Dependency_hell)

# 常用命令

*　常用命令及关系
  *　`dpkg`: 最底层的命令, 用于安装,构建,删除和管理Debian包(后缀`.deb`)
  *　`apt-get`: 基于`dpkg`命令, 提供更上层的命令. 相当于用户接口的前端
  *　`apt`: 基于`apt-get`, `apt-cache`, 简单的封装了下接口, 简化使用. 用于管理包, 能够处理包之间的依赖关系然后自动下载.
* 通常使用`apt`, 需要更底层功能时使用`apt-get`

> 详细见[deepin 程序管理](https://wiki.deepin.org/wiki/Deepin系统管理#.E7.A8.8B.E5.BA.8F.E7.AE.A1.E7.90.86)

下面列举一些常用的命令使用:

* `apt update`从配置文件中更新包信息, 大多数命令依赖与该信息执行的.
* `apt upgrade`更新所有从软件仓库中安装的包
* `apt install`安装
* `apt remote`删除, 但不删除配置文件
* `apt purge`删除包的配置文件
* `apt autoremove`删除自动安装, 现在却不再需要的包
* `apt search`搜索某个包
* `apt list`显示全部或满足规则的所有包. 
  * `--installed`已安装的
  * `--upgradeable`可升级的
  * `--all-versions`所有版本

# 软件源

这些命令安装的软件来源于软件源.

在以下两处可配置软件源

* `/etc/apt/sources.list`
* `/etc/apt/sources.list.d/` 用于添加源到一个单独的地方, 文件名一般以`.list`结尾, 如`vscode.list`

一般配置文件中一行为一条软件源, 软件版本冲突时, 先找到的优先级高. 软件源可以通过命令添加, 或直接编辑文件.

> 命令添加时用` add-apt-repository`, 一般该命令不是预装的.

## 配置

主要的是理清一条软件源的书写格式, 软件和源码源书写格式如下:

```plain
deb [ option1=value1 option2=value2 ] uri suite [component1] [component2] [...]
deb-src [ option1=value1 option2=value2 ] uri suite [component1] [component2] [...]
```

其他不谈, 主要看

* `uri`: 仓库所在的uri

* `deb`的类型主要由`suite/component`标识, `suite`一般与自己的仓库相关. 常选值为`stable main`

  > 错误纠正: 选值并不是这么简单, 具体不知. 还是建议用命令安装源

## 例子

这里添加wine源到deepin中

```plain
## Generated by deepin-installer
deb [by-hash=force] http://packages.deepin.com/deepin lion main contrib non-free
#deb-src http://packages.deepin.com/deepin lion main contrib non-free

# set by sidian
deb https://dl.winehq.org/wine-builds/ubuntu/ cosmic main
```

然后刷新配置到应用中

```bash
sudo apt-get update
```





























